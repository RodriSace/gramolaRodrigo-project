<div class="container" style="max-width: 800px; margin-top: 2rem;">
  
  <h2 class="text-center mb-4">Buscar Música</h2>

  <div class="search-box card" style="background: rgba(30,30,30,0.6); padding: 1.5rem;">
    <div style="position: relative;">
      <span class="material-icons" style="position: absolute; left: 15px; top: 12px; color: #888;">search</span>
      <input type="text" [(ngModel)]="query" (input)="onQueryChange()" placeholder="Busca por canción, artista..."
             style="width: 100%; padding: 12px 12px 12px 45px; border-radius: 50px; border: none; background: rgba(255,255,255,0.1); color: white;">
    </div>
  </div>

  <div class="results-list" *ngIf="results.length > 0">
    <h3 style="margin: 2rem 0 1rem; color: var(--secondary-color);">Resultados</h3>
    
    <div class="song-card" *ngFor="let song of results" style="display: flex; align-items: center; background: rgba(255,255,255,0.05); padding: 15px; margin-bottom: 10px; border-radius: 12px; transition: 0.2s;">
      <img [src]="song.albumCover || 'data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNjAiIGhlaWdodD0iNjAiIHZpZXdCb3g9IjAgMCA2MCA2MCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHJlY3Qgd2lkdGg9IjYwIiBoZWlnaHQ9IjYwIiBmaWxsPSIjY2NjY2NjIi8+Cjx0ZXh0IHg9IjMwIiB5PSIzNSIgZm9udC1mYW1pbHk9IkFyaWFsLCBzYW5zLXNlcmlmIiBmb250LXNpemU9IjEwIiBmaWxsPSIjZmZmZmZmIiB0ZXh0LWFuY2hvcj0ibWlkZGxlIj5ObyBDb3ZlcjwvdGV4dD4KPHN2Zz4='" alt="Cover" style="width: 60px; height: 60px; border-radius: 8px; object-fit: cover;" (error)="$event.target.src='data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNjAiIGhlaWdodD0iNjAiIHZpZXdCb3g9IjAgMCA2MCA2MCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHJlY3Qgd2lkdGg9IjYwIiBoZWlnaHQ9IjYwIiBmaWxsPSIjY2NjY2NjIi8+Cjx0ZXh0IHg9IjMwIiB5PSIzNSIgZm9udC1mYW1pbHk9IkFyaWFsLCBzYW5zLXNlcmlmIiBmb250LXNpemU9IjEwIiBmaWxsPSIjZmZmZmZmIiB0ZXh0LWFuY2hvcj0ibWlkZGxlIj5ObyBDb3ZlcjwvdGV4dD4KPHN2Zz4='">
      
      <div style="flex: 1; margin-left: 15px;">
        <div style="font-weight: bold; font-size: 1.1rem; color: white;">{{ song.title }}</div>
        <div style="color: #aaa; font-size: 0.9rem;">{{ song.artist }}</div>
      </div>
      
      <button class="btn-secondary" (click)="initiatePayment(song)" style="border-radius: 20px; padding: 8px 16px; font-size: 0.9rem; display: flex; align-items: center; gap: 5px;">
        <span class="material-icons" style="font-size: 18px;">add_shopping_cart</span> 
        {{ (priceInCents/100) | number:'1.2-2' }}€
      </button>
    </div>
  </div>

  <div *ngIf="results.length === 0 && !isLoading && query !== ''" class="text-center" style="margin-top: 3rem; color: #666;">
    <span class="material-icons" style="font-size: 3rem;">music_off</span>
    <p>No se encontraron resultados.</p>
  </div>

  <app-payment-form
    *ngIf="selectedSongForPayment"
    [songTitle]="selectedSongForPayment.title"
    [price]="priceInCents / 100"
    [songData]="selectedSongForPayment"
    (cancel)="cancelPayment()"
    (success)="onPaymentSuccess()">
  </app-payment-form>

</div>

<div *ngIf="showNotification" class="toast-notification">
  <div class="toast-content">
    <span class="icon">✅</span>
    <span>{{ notificationMessage }}</span>
  </div>
</div>
